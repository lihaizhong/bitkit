!function(e){"use strict";function t(n){this._setting=t.extend({},t.defaultSettings,e.ajax.setup,n),this.init()}t.defaultSettings={url:"",method:"GET",data:null,dataType:"",contentType:"application/x-www-form-urlencoded;charset=UTF-8",async:!0,user:"",password:"",cache:!0,headers:null,context:null,beforeSend:null,success:null,error:null,complete:null},t.util={getBaseType:function(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()},isObject:function(e){return"object"===this.getBaseType(e)},isFunction:function(e){return"function"==typeof e},isString:function(e){return"string"==typeof e}},t.extend=function(e){var n,r,s=arguments.length,o=1;if(0==s)return{};for(t.util.isObject(e)&&(e={});o<s;o++)if(n=arguments[o],t.util.isObject(n)&&n!==t&&n!==t.prototype&&e!==n)for(r in n)n.hasOwnProperty(r)&&(e[r]=n[r]);return e},t.addURLParams=function(e,n,r){var s,o;if(!t.util.isString(e))throw new Error("url必须是字符串!");if(t.util.isObject(n))for(s in n)o=n[s],n.hasOwnProperty(s)&&(e+=e.indexOf("?")==-1?"?":"&",e+=encodeURIComponent(s)+"="+encodeURIComponent(o));return r&&(e+=e.indexOf("?")==-1?"?":"&",e+="_="+(new Date).getTime()),e},t.setRequestHeaders=function(e,n){var r,s;if(t.util.isObject(n))for(r in n)s=n[r],n.hasOwnProperty(r)&&void 0!==s&&e.setRequestHeader(r,s)},t.getResponseData=function(e){var t;if("json"===e.responseType)t=e.response;else try{t=JSON.parse(e.responseText)}catch(n){t=e.responseText}return t},t.prototype={constructor:t,init:function(){var n=this,r=n._setting,s=r.url,o=r.method,i=void 0===r.data?null:r.data,a=new XMLHttpRequest;n.xhr=a,n._onreadyStateChange(),t.util.isString(s)&&""!=s||(s=e.location.href),"post"!=o.toLowerCase()&&(s=t.addURLParams(s,i,r.cache),i=null),a.open(o,s,r.async,r.user,r.password),a.send(i)},abort:function(){var e=this.xhr;t.util.isObject(e)&&(e.abort(),e=null)},_onreadyStateChange:function(){var e=this;e.xhr.onreadystatechange=function(){switch(e.xhr.readyState){case 0:break;case 1:e._open();break;case 2:break;case 3:break;case 4:e._finish()}}},_open:function(){var e=this,n=e.xhr,r=e._setting,s=r.beforeSend,o=t.extend({},r.headers,{"X-Requested-With":"XMLHttpRequest"});"get"===r.method.toLowerCase()?delete o["Content-Type"]:o["Content-Type"]=r.contentType,t.setRequestHeaders(n,o),n.responseType=r.dataType,t.util.isFunction(s)&&s.call(r.context,n)},_finish:function(){var e,n=this,r=n._setting,s=n.xhr,o=r.context,i=r.success,a=r.error,c=r.complete,u=s.status,l=s.statusText;try{u>=200&&u<300||304==u?(e=t.getResponseData(s),t.util.isFunction(i)&&i.call(o,e,l,s)):t.util.isFunction(a)&&a.call(o,e,l,s),t.util.isFunction(c)&&c.call(o,l,s)}catch(e){console.log(e)}}};var n=function(e){return new t(e)};e.ajax=n}(window);