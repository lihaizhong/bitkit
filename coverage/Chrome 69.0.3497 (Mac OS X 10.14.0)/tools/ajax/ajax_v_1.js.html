<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for tools/ajax/ajax_v_1.js</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../../prettify.css" />
    <link rel="stylesheet" href="../../base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="../../index.html">all files</a> / <a href="index.html">tools/ajax/</a> ajax_v_1.js
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">40.91% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>18/44</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">3.85% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>1/26</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">27.27% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>3/11</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">48.65% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>18/37</span>
      </div>
    </div>
  </div>
  <div class='status-line low'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100</td><td class="line-coverage quiet"><span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		<span class="missing-if-branch" title="if path not taken" >I</span>if(installedModules[moduleId]) {
/******/ 			<span class="cstat-no" title="statement not covered" >return installedModules[moduleId].exports;</span>
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = <span class="fstat-no" title="function not covered" >function(exports, name, getter) {</span>
/******/ 		<span class="cstat-no" title="statement not covered" >if(!__webpack_require__.o(exports, name)) {</span>
/******/ 			<span class="cstat-no" title="statement not covered" >Object.defineProperty(exports, name, { enumerable: true, get: getter });</span>
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = <span class="fstat-no" title="function not covered" >function(exports) {</span>
/******/ 		<span class="cstat-no" title="statement not covered" >if(typeof Symbol !== 'undefined' &amp;&amp; Symbol.toStringTag) {</span>
/******/ 			<span class="cstat-no" title="statement not covered" >Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });</span>
/******/ 		}
/******/ 		<span class="cstat-no" title="statement not covered" >Object.defineProperty(exports, '__esModule', { value: true });</span>
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode &amp; 1: value is a module id, require it
/******/ 	// mode &amp; 2: merge all properties of value into the ns
/******/ 	// mode &amp; 4: return value when already ns object
/******/ 	// mode &amp; 8|1: behave like require
/******/ 	__webpack_require__.t = <span class="fstat-no" title="function not covered" >function(value, mode) {</span>
/******/ 		<span class="cstat-no" title="statement not covered" >if(mode &amp; 1) <span class="cstat-no" title="statement not covered" >value = __webpack_require__(value);</span></span>
/******/ 		<span class="cstat-no" title="statement not covered" >if(mode &amp; 8) <span class="cstat-no" title="statement not covered" >return value;</span></span>
/******/ 		<span class="cstat-no" title="statement not covered" >if((mode &amp; 4) &amp;&amp; typeof value === 'object' &amp;&amp; value &amp;&amp; value.__esModule) <span class="cstat-no" title="statement not covered" >return value;</span></span>
/******/ 		<span class="cstat-no" title="statement not covered" >var ns = Object.create(null);</span>
/******/ 		<span class="cstat-no" title="statement not covered" >__webpack_require__.r(ns);</span>
/******/ 		<span class="cstat-no" title="statement not covered" >Object.defineProperty(ns, 'default', { enumerable: true, value: value });</span>
/******/ 		<span class="cstat-no" title="statement not covered" >if(mode &amp; 2 &amp;&amp; typeof value != 'string') <span class="cstat-no" title="statement not covered" >for(var key in value) <span class="cstat-no" title="statement not covered" >__webpack_require__.d(ns, key, <span class="fstat-no" title="function not covered" >function(key) {</span> <span class="cstat-no" title="statement not covered" >return value[key]; </span>}.bind(null, key));</span></span></span>
/******/ 		<span class="cstat-no" title="statement not covered" >return ns;</span>
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = <span class="fstat-no" title="function not covered" >function(module) {</span>
/******/ 		<span class="cstat-no" title="statement not covered" >var getter = module &amp;&amp; module.__esModule ?</span>
/******/ 			<span class="fstat-no" title="function not covered" >function getDefault() {</span> <span class="cstat-no" title="statement not covered" >return module['default']; </span>} :
/******/ 			<span class="fstat-no" title="function not covered" >function getModuleExports() {</span> <span class="cstat-no" title="statement not covered" >return module; </span>};
/******/ 		<span class="cstat-no" title="statement not covered" >__webpack_require__.d(getter, 'a', getter);</span>
/******/ 		<span class="cstat-no" title="statement not covered" >return getter;</span>
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = <span class="fstat-no" title="function not covered" >function(object, property) {</span> <span class="cstat-no" title="statement not covered" >return Object.prototype.hasOwnProperty.call(object, property); </span>};
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "/var/folders/m3/cm2m6_9n1_bcq5px23bjyldm0000gn/T/_karma_webpack_/";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = "./tools/ajax/ajax_v_1.js");
/******/ })
/************************************************************************/
/******/ ({
&nbsp;
/***/ "./tools/ajax/ajax_v_1.js":
/*!********************************!*\
  !*** ./tools/ajax/ajax_v_1.js ***!
  \********************************/
/*! no static exports found */
/***/ (function(module, exports) {
&nbsp;
eval("/**\n * Created by sky on 16/10/13.\n * Ajax Level 1 Implemention\n */\n;\n\n(function (global) {\n  'use strict'; // Ajax 构造函数\n\n  function Ajax(options) {\n    this._setting = Ajax.extend({}, Ajax.defaultSettings,\n    /* 全局设置 */\n    global.ajax.setup, options);\n    this.init();\n  } // 基础参数设置\n\n\n  Ajax.defaultSettings = {\n    /* Params */\n    url: '',\n    method: 'GET',\n    data: null,\n    dataType: '',\n    contentType: 'application/x-www-form-urlencoded;charset=UTF-8',\n    // accepts: null,\n    // converters: null,\n    async: true,\n    user: '',\n    password: '',\n    cache: true,\n    headers: null,\n    context: null,\n\n    /* Callback Function */\n    beforeSend: null,\n    success: null,\n    error: null,\n    complete: null\n  }; // 常用工具集\n\n  Ajax.util = {\n    getBaseType: function (o) {\n      return Object.prototype.toString.call(o).slice(8, -1).toLowerCase();\n    },\n    isObject: function (o) {\n      return this.getBaseType(o) === 'object';\n    },\n    isFunction: function (fn) {\n      return typeof fn === 'function';\n    },\n    isString: function (str) {\n      return typeof str === 'string';\n    }\n  };\n  /**\n   * 数据扩展合并（浅拷贝）\n   * @param target\n   * @return {Object}\n   */\n\n  Ajax.extend = function (target) {\n    var len = arguments.length,\n        item,\n        key,\n        i = 1;\n\n    if (len == 0) {\n      return {};\n    }\n\n    if (Ajax.util.isObject(target)) {\n      target = {};\n    }\n\n    for (; i &lt; len; i++) {\n      item = arguments[i];\n\n      if (!Ajax.util.isObject(item) || item === Ajax || item === Ajax.prototype || target === item) {\n        continue;\n      }\n\n      for (key in item) {\n        if (item.hasOwnProperty(key)) {\n          target[key] = item[key];\n        }\n      }\n    }\n\n    return target;\n  };\n  /** GET\n   * 如果是GET请求，将参数添加到url上\n   * @param url\n   * @param params\n   * @return {String}\n   */\n\n\n  Ajax.addURLParams = function (url, params, cache) {\n    var name, value;\n\n    if (!Ajax.util.isString(url)) {\n      throw new Error('url必须是字符串!');\n    }\n\n    if (Ajax.util.isObject(params)) {\n      // 将参数追加到url后面\n      for (name in params) {\n        value = params[name];\n\n        if (params.hasOwnProperty(name)) {\n          url += url.indexOf('?') == -1 ? '?' : '&amp;';\n          url += encodeURIComponent(name) + '=' + encodeURIComponent(value);\n        }\n      }\n    } // 是否添加缓存\n\n\n    if (cache) {\n      url += url.indexOf('?') == -1 ? '?' : '&amp;';\n      url += '_=' + new Date().getTime();\n    }\n\n    return url;\n  };\n  /**\n   * 设置自定义header\n   * @param xhr\n   * @param headers\n   */\n\n\n  Ajax.setRequestHeaders = function (xhr, headers) {\n    var key, value;\n\n    if (Ajax.util.isObject(headers)) {\n      for (key in headers) {\n        value = headers[key]; // 如果key不是header的自有属性或者value为undefined，则跳过\n\n        if (!headers.hasOwnProperty(key) || value === undefined) {\n          continue;\n        } // 设置自定义的头部信息\n\n\n        xhr.setRequestHeader(key, value);\n      }\n    }\n  };\n  /**\n   * 处理并返回处理后的响应数据\n   * @param xhr\n   * @return {*}\n   */\n\n\n  Ajax.getResponseData = function (xhr) {\n    var result;\n\n    if (xhr.responseType === 'json') {\n      result = xhr.response;\n    } else {\n      try {\n        result = JSON.parse(xhr.responseText);\n      } catch (ex) {\n        result = xhr.responseText;\n      }\n    }\n\n    return result;\n  };\n\n  Ajax.prototype = {\n    constructor: Ajax,\n\n    /**\n     * 初始化\n     */\n    init: function () {\n      var self = this,\n          setting = self._setting,\n          url = setting.url,\n          method = setting.method,\n          data = setting.data === undefined ? null : setting.data; // 创建XMLHttpRequest实例\n\n      var xhr = new XMLHttpRequest();\n      self.xhr = xhr; // 监听readystatuschange事件\n\n      self._onreadyStateChange(); // 非法url处理\n\n\n      if (!(Ajax.util.isString(url) &amp;&amp; url != '')) {\n        url = global.location.href;\n      } // 如果不是post请求，则认为是get请求\n\n\n      if (method.toLowerCase() != 'post') {\n        url = Ajax.addURLParams(url, data, setting.cache);\n        data = null;\n      }\n\n      xhr.open(method, url, setting.async, setting.user, setting.password); // 如果为get请求，data为null\n\n      xhr.send(data);\n    },\n\n    /**\n     * 中止ajax请求\n     */\n    abort: function () {\n      var xhr = this.xhr;\n\n      if (Ajax.util.isObject(xhr)) {\n        xhr.abort();\n        xhr = null;\n      }\n    },\n\n    /**\n     * 监听readystatechange事件\n     * @private\n     */\n    _onreadyStateChange: function () {\n      var self = this; // 绑定readystatechange事件\n\n      self.xhr.onreadystatechange = function () {\n        switch (self.xhr.readyState) {\n          // 未初始化。尚未调用open方法。\n          case 0:\n            break;\n          // 启动。已经调用open方法，但尚未调用send方法。\n\n          case 1:\n            self._open();\n\n            break;\n          // 发送。已经调用send方法，但尚未接收到响应。\n\n          case 2:\n            break;\n          // 接收。已经接收到部分响应数据。\n\n          case 3:\n            break;\n          // 完成。已经接收到全部响应数据，而且已经可以在客户端使用了。\n\n          case 4:\n            self._finish();\n\n            break;\n        }\n      };\n    },\n\n    /**\n     * readyState 1\n     * open方法启动后，send方法启动前，才能设置http header头信息\n     * @private\n     */\n    _open: function () {\n      var self = this,\n          xhr = self.xhr,\n          setting = self._setting,\n          beforeSend = setting.beforeSend,\n          headers = Ajax.extend({}, setting.headers, {\n        'X-Requested-With': 'XMLHttpRequest'\n      });\n\n      if (setting.method.toLowerCase() === 'get') {\n        delete headers['Content-Type'];\n      } else {\n        headers['Content-Type'] = setting.contentType;\n      } // 设置自定义头部信息\n\n\n      Ajax.setRequestHeaders(xhr, headers);\n      xhr.responseType = setting.dataType;\n      Ajax.util.isFunction(beforeSend) &amp;&amp; beforeSend.call(setting.context, xhr);\n    },\n\n    /**\n     * readyState 4\n     * 整个请求已经完成，结果已经返回，客户端可以访问\n     * @private\n     */\n    _finish: function () {\n      var self = this,\n          setting = self._setting,\n          xhr = self.xhr,\n          context = setting.context,\n          success = setting.success,\n          error = setting.error,\n          complete = setting.complete,\n          status = xhr.status,\n          statusText = xhr.statusText,\n          responseData;\n\n      try {\n        if (status &gt;= 200 &amp;&amp; status &lt; 300 || status == 304) {\n          // 响应成功\n          responseData = Ajax.getResponseData(xhr);\n          Ajax.util.isFunction(success) &amp;&amp; success.call(context, responseData, statusText, xhr);\n        } else {\n          // 响应失败\n          Ajax.util.isFunction(error) &amp;&amp; error.call(context, responseData, statusText, xhr);\n        } // 响应完成\n\n\n        Ajax.util.isFunction(complete) &amp;&amp; complete.call(context, statusText, xhr);\n      } catch (ex) {\n        console.error(ex);\n      }\n    }\n  };\n  /**\n   * EXPORTS\n   * @param options\n   * @return {*}\n   */\n\n  var ajax = function (options) {\n    // 返回ajax实例\n    return new Ajax(options);\n  };\n\n  global.ajax = ajax;\n})(window);\n\n//# sourceURL=webpack:///./tools/ajax/ajax_v_1.js?");
&nbsp;
/***/ })
&nbsp;
/******/ });</pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->
<div class='footer quiet pad2 space-top1 center small'>
  Code coverage
  generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Thu Sep 27 2018 18:08:06 GMT+0800 (CST)
</div>
</div>
<script src="../../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../../sorter.js"></script>
</body>
</html>
